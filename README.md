# 99francs_platform
99francs Platform repository

**Домашняя работа №1**

В рамках выполнения домашнего задания полученного после лекции 
"Знакомство с Kubernetes",была проделана следующая работа:
 - Создан образ веб сервера на базе официального образа Nginx работающего из-под пользователя с UID 1001
 - Образ веб сервера размещён на Docker Hub
 - Были найдены причины падения приложения fronted, а именно: не хватало целого списка переменных, 
 которые были найдены в подсказках с нужными значениями. После добавления, контейнер перешёл в статус Running

**Домашняя работа №2**

В рамках выполнения домашнего задания полученного после лекции "Механика запуска и взаимодействия контейнеров в Kubernetes",
была проделана следующая работа:
- Развернут kind по конфигу из Д/З
    ```yaml
    kind: Cluster
    apiVersion: kind.x-k8s.io/v1alpha4
    nodes:
      - role: control-plane
      - role: control-plane
      - role: control-plane
      - role: worker
      - role: worker
      - role: worker
    ```
- Ответ на вопрос из Д/З **Почему обновление ReplicaSet не повлекло обновление запущенных pod?:**
*ReplicaSet чувствителен к количеству запущенных реплик подов, которые матчатся по меткам с самим RS, тем самым игнорируя теги. Поэтому количество подов соответствующих метке app=fronted уже в нужном количестве, и перезапуск не требуется.* 

- Созданы образа **paymentservice** по аналогии с **frontend**, и запушил в docker hub.
- Созданы Deployment манифесты на базе Replicaset. 
- Созданы Deplyomet манифесты из задания со *, который имитируют сценарий blue/green и revers update   
- Создан манифест DaemonSet. Добавлена в манифест возможность запускаться на мастер-нодах

**Домашняя работа №3**

В рамках выполнения домашней работы, были созданы сервис аккаунты в кластере, а также присвоены им права

**Домашняя работа №4**
В рамках Д/З сделано:
- Протестированы пробы жизни и пробы готовности принимать трафик.
- Осуществлена полноценная работа с типом развертывания Deployment
- Протестированы различные варианты параметры для деплоймента **maxUnavailable** и **maxSurge**. В качестве эксперимента применялись крайние значения для обоих
- Взаимодействие с самым распространенным типом **Service**  — **ClusterIP**. Данный тип является одним из самых распространенных, и имеет ряд ограничений
- Перенастройка minikube с использованием kube-proxy в режиме ipvs, т.к он имеет больше возможности для взаимодействия с сервисами.
 Например, присвоение IP из определенной сети, которая может быть доступна извне. Адреса из сети присваиваются на виртуальный интерфейс ноды
- Работа с L4 балансировщиком MetalLb
- Выполнение задачи со звёздочкой, а именно, проброс DNS-трафика в кластер при помощи MetalLB
- Деплой в minikube контроллера ingress-nginx  
- Протестирована работа Service без IP адресов
- Развертывание kubernetes-dasboard в minikube в контекстном пути **/dashboard**
- Выполнение задачи со звёздочкой: развертывание приложения с канареечным деплоем. 
В нашем случае канареечный деплой был реализован при помощи ingress-nginx и заголовков. 
В рамках данной задачи было создано два деплоймента, два сервиса и два ингресса с одинаковым хостом, но разными аннотациями.
Т.е. при обычном запросе трафик попадал на **web-app** приложение. 
В случае наличия в заголовке запросов header **canary: yes**, то данный запрос перенаправляется на **web-app-canary** приложение.
